<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SMC algorithm · SequentialMonteCarlo.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SequentialMonteCarlo.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Contents</a></li><li><a class="tocitem" href="../intro/">Introduction</a></li><li><a class="tocitem" href="../smcintegrals/">SMC integrals</a></li><li class="is-active"><a class="tocitem" href>SMC algorithm</a><ul class="internal"><li><a class="tocitem" href="#basicsmc"><span>SMC algorithm</span></a></li><li><a class="tocitem" href="#mainapprox"><span>Main particle approximations</span></a></li><li><a class="tocitem" href="#Genealogical-structure"><span>Genealogical structure</span></a></li><li><a class="tocitem" href="#Recursive-definition"><span>Recursive definition</span></a></li></ul></li><li><a class="tocitem" href="../smctheory/">Theoretical properties</a></li><li><a class="tocitem" href="../smcve/">Variance estimators</a></li><li><a class="tocitem" href="../smcadaptive/">Adaptive resampling</a></li><li><a class="tocitem" href="../csmc/">Conditional SMC</a></li><li><a class="tocitem" href="../impl/">Implementation notes</a></li><li><a class="tocitem" href="../performance/">Performance tips</a></li><li><a class="tocitem" href="../smcinterface/">SMC interface</a></li><li><a class="tocitem" href="../guide/">Types and functions</a></li><li><a class="tocitem" href="../hmm/">Hidden Markov models</a></li><li><a class="tocitem" href="../bench/">Benchmarks</a></li><li><a class="tocitem" href="../refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>SMC algorithm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SMC algorithm</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/awllee/SequentialMonteCarlo.jl/blob/master/docs/src/smcalgorithm.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SMC-algorithm-and-particle-approximations"><a class="docs-heading-anchor" href="#SMC-algorithm-and-particle-approximations">SMC algorithm and particle approximations</a><a id="SMC-algorithm-and-particle-approximations-1"></a><a class="docs-heading-anchor-permalink" href="#SMC-algorithm-and-particle-approximations" title="Permalink"></a></h1><h2 id="basicsmc"><a class="docs-heading-anchor" href="#basicsmc">SMC algorithm</a><a id="basicsmc-1"></a><a class="docs-heading-anchor-permalink" href="#basicsmc" title="Permalink"></a></h2><p>The implemented algorithm is as follows. The random variables <span>$\zeta_p^1, \ldots, \zeta_p^N$</span> are typically referred to as particles, and the approximations they define are referred to as particle approximations.</p><hr/><ol><li><p>Sample <span>$\zeta_1^i \overset{\mathrm{i.i.d.}}{\sim} M_1$</span> for <span>$i \in \{1,\ldots,N\}$</span>.</p></li><li><p>For <span>$p=2,\ldots,n$</span>:</p><ul><li><p>sample a vector <span>$A_{p-1}^1,\ldots,A_{p-1}^N$</span> of i.i.d. <span>${\rm Categorical}(G_{p-1}(\zeta_{p-1}^1),\ldots,G_{p-1}(\zeta_{p-1}^N))$</span> random variables in increasing order.</p></li><li><p>sample <span>$\zeta_p^i \overset{\mathrm{ind}} {\sim} M_p(\zeta_{p-1}^{A_{p-1}^i}, \cdot)$</span> for <span>$i \in \{1,\ldots,N\}$</span>.</p></li></ul></li></ol><hr/><p>This algorithm is referred to as SMC with multinomial resampling because the vector of numbers of <em>offspring</em> of the time <span>$p-1$</span> particles follows a multinomial distribution.</p><h2 id="mainapprox"><a class="docs-heading-anchor" href="#mainapprox">Main particle approximations</a><a id="mainapprox-1"></a><a class="docs-heading-anchor-permalink" href="#mainapprox" title="Permalink"></a></h2><p>For some <span>$p \in \{1,\ldots,n\}$</span>, the particle approximation of <span>$\eta_p(f)$</span> is obtained by constructing a particle approximation <span>$\eta_p^N$</span> of <span>$\eta_p$</span> and then calculating <span>$\eta_p^N(f)$</span>. Specifically, we define</p><p class="math-container">\[\eta_p^N := \frac{1}{N} \sum_{i=1}^N \delta_{\zeta_p^i}, \qquad p \in \{1,\ldots,n\}\]</p><p>and the particle approximation of <span>$\eta_p(f)$</span> is then simply</p><p class="math-container">\[\eta_p^N(f) = \int f(x) \eta_p^N({\rm d}x) = \frac{1}{N} \sum_{i=1}^N f(\zeta_p^i).\]</p><p>Similarly, we define</p><p class="math-container">\[\hat{\eta}_p^N:= \frac{\eta_p^N \cdot G_p}{\eta_p^N(G_p)}, \qquad p \in \{1, \ldots, n\}\]</p><p>so that the particle approximation of <span>$\hat{\eta}_p(f)$</span> is</p><p class="math-container">\[\hat{\eta}^N_p(f) = \int f(x) \hat{\eta}_p^N({\rm d}x) \frac{\sum_{i=1}^N G_p(\zeta_p^i) f(\zeta_p^i)}{\sum_{i=1}^N G_p(\zeta_p^i)}.\]</p><p>Finally, the particle approximations of <span>$\hat{Z}_1,\ldots,\hat{Z}_n$</span> are defined by <span>$\hat{Z}_1^N:=\eta_1^N(G_1)$</span> and for <span>$p \in \{2,\ldots,n\}$</span>, <span>$\hat{Z}_p^N:=\hat{Z}_{p-1}^N\eta_p^N(G_p)$</span>.</p><h2 id="Genealogical-structure"><a class="docs-heading-anchor" href="#Genealogical-structure">Genealogical structure</a><a id="Genealogical-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Genealogical-structure" title="Permalink"></a></h2><p>The particle system defined by the SMC algorithm has a genealogical structure, induced by the ancestor indices. We define Eve indices such that <span>$E_p^i$</span> is the index of the time <span>$1$</span> ancestor of <span>$\zeta_p^i$</span>. That is, the Eve indices satisfy <span>$E_1^i := i$</span> for <span>$i \in \{1, \ldots, N\}$</span> and</p><p class="math-container">\[E_p^i = E_{p-1}^{A_{p-1}^i}, \qquad p \in \{2, \ldots, n\}, \quad i \in \{1, \ldots, N\}.\]</p><p>These can be used to quantify and visualize the path degeneracy phenomenon associated with the SMC algorithm. Since the ancestor indices are in sorted order, so too are the Eve indices at each time.</p><h2 id="Recursive-definition"><a class="docs-heading-anchor" href="#Recursive-definition">Recursive definition</a><a id="Recursive-definition-1"></a><a class="docs-heading-anchor-permalink" href="#Recursive-definition" title="Permalink"></a></h2><p>The SMC algorithm is intimately connected to the <a href="../smcintegrals/#recursivedefmeasures">recursive definition of the SMC measures</a> themselves.</p><p>Let us define the sampling operator <span>$S^N$</span> to be the random map that takes a measure <span>$\mu$</span> and outputs a random measure</p><p class="math-container">\[\mu^N = S^N \mu = \frac{1}{N} \sum_{i=1}^N \delta_{X^i}, \qquad \text{where } X^i \overset{\mathrm{i.i.d.}}{\sim} \mu.\]</p><p>Then we have</p><p class="math-container">\[\eta^N_1 = S^N M_1, \qquad \hat{\eta}_1^N = \frac {\eta^N_1 \cdot G_1} {\eta^N_1(G_1)},\]</p><p>and for <span>$p = 2, \ldots, n$</span>,</p><p class="math-container">\[\eta^N_p = S^N (\hat{\eta}_{p-1}^N M_p), \qquad \hat{\eta}_p^N = \frac {\eta^N_p \cdot G_p} {\eta^N_p(G_p)}.\]</p><p>This mirrors almost exactly the recursive definitions for the SMC measures, where one has instead</p><p class="math-container">\[\eta_1 = M_1, \qquad \hat{\eta}_1 = \frac {\eta_1 \cdot G_1} {\eta_1(G_1)},\]</p><p>and for <span>$p = 2, \ldots, n$</span>,</p><p class="math-container">\[\eta_p = \hat{\eta}_{p-1} M_p, \qquad \hat{\eta}_p = \frac {\eta_p \cdot G_p} {\eta_p(G_p)}.\]</p><p>We notice also that <span>$\hat{Z}^N_p = \hat{Z}^N_{p-1} \eta^N_p(G_p)$</span> while <span>$\hat{Z}_p = \hat{Z}_{p-1} \eta_p(G_p)$</span> for <span>$p \in \{2, \ldots, n\}$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../smcintegrals/">« SMC integrals</a><a class="docs-footer-nextpage" href="../smctheory/">Theoretical properties »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Friday 3 September 2021 13:53">Friday 3 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
